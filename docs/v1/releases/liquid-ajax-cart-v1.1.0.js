var t={d:(e,r)=>{for(var a in r)t.o(r,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:r[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{x$:()=>n,nd:()=>i,yF:()=>u,fi:()=>s,Be:()=>c,jQ:()=>m,KJ:()=>q,Q4:()=>d,w0:()=>A});const r=[],a=t=>{switch(t){case"add":return"/cart/add.js";case"change":return"/cart/change.js";case"get":return"/cart.js";case"clear":return"/cart/clear.js";case"update":return"/cart/update.js";default:return}},o=(t,e,o={})=>{const s=a(t);let n;"get"!==t&&(n=e);const i="get"===t?"GET":"POST",c="firstComplete"in o?[o.firstComplete]:[],u={requestType:t,endpoint:s};r.forEach((e=>{try{e({requestType:t,endpoint:s,requestBody:n},(t=>c.push(t)))}catch(t){console.error("Liquid Ajax Cart: Error during Ajax request subscriber callback in ajax-api"),console.error(t)}})),"lastComplete"in o&&c.push(o.lastComplete),u.requestBody=n;const d={method:i};"get"!==t&&(n instanceof FormData||n instanceof URLSearchParams?(d.body=n,d.headers={"x-requested-with":"XMLHttpRequest"}):(d.body=JSON.stringify(n),d.headers={"Content-Type":"application/json"})),fetch(s,d).then((t=>t.json().then((e=>({ok:t.ok,status:t.status,body:e}))))).then((e=>(u.responseData=e,"add"!==t?u:fetch(a("get"),{method:"GET",headers:{"Content-Type":"application/json"}}).then((t=>t.json().then((e=>(u.extraResponseData={ok:t.ok,status:t.status,body:e},u)))))))).catch((t=>{console.error("Liquid Ajax Cart: Error while performing cart Ajax request"),console.error(t),u.fetchError=t})).finally((()=>{c.forEach((t=>{try{t(u)}catch(t){console.error("Liquid Ajax Cart: Error during Ajax request result callback in ajax-api"),console.error(t)}}))}))},s=t=>{o("get",void 0,t)},n=(t,e)=>{o("add",t,e)},i=(t,e)=>{o("change",t,e)},c=(t,e)=>{o("update",t,e)},u=(t,e)=>{o("clear",t,e)},d=t=>{r.push(t)},l={productFormsFilter:t=>!0};let p={};const m=(t={})=>{p={...l,...t},p.computed={productFormsErrorsAttribute:"data-ajax-cart-form-error",sectionsAttribute:"data-ajax-cart-section",binderAttribute:"data-ajax-cart-bind-state",requestButtonAttribute:"data-ajax-cart-request-button",toggleClassButtonAttribute:"data-ajax-cart-toggle-class-button",initialStateAttribute:"data-ajax-cart-initial-state",sectionScrollAreaAttribute:"data-ajax-cart-section-scroll",quantityInputAttribute:"data-ajax-cart-quantity-input",cartStateSetBodyClass:"js-ajax-cart-set",requestInProgressBodyClass:"js-ajax-cart-request-in-progress",emptyCartBodyClass:"js-ajax-cart-empty",notEmptyCartBodyClass:"js-ajax-cart-not-empty",productFormsProcessingClass:"js-ajax-cart-form-in-progress"}};m();const h={all:0},f=[];let y={},b={requestInProgress:!1,cartStateSet:!1};const g=()=>{b.requestInProgress=h.all>0,b.cartStateSet="item_count"in y,S()},A=t=>{try{t({cart:y,status:b}),f.push(t)}catch(t){console.log("Liquid Ajax Cart: Error during subscribing to the state"),console.error(t)}},q=()=>({cart:y,status:b}),S=()=>{f.forEach((t=>{try{t({cart:y,status:b})}catch(t){console.error(t)}}))};(()=>{d(((t,e)=>{h.all++,g(),e((t=>{(t=>{h.all--,"responseData"in t&&t.responseData.ok&&("add"===t.requestType?"extraResponseData"in t&&t.extraResponseData.ok?y=t.extraResponseData.body:s():y=t.responseData.body)})(t),g()}))}));const t=document.querySelector(`[${p.computed.initialStateAttribute}]`);if(t)try{const e=JSON.parse(t.textContent);if(!("item_count"in e))throw`JSON from ${p.computed.initialStateAttribute} script is not correct cart object`;y=e,g()}catch(t){console.error(`Can't parse cart JSON from ${p.computed.initialStateAttribute} script`),console.error(t),s()}else s()})();const j=t=>{const e=p.computed.binderAttribute;t.status.cartStateSet&&document.querySelectorAll(`[${e}]`).forEach((t=>{const r=t.getAttribute(e),a=x(r);void 0!==a&&(t.innerText=a)}))},x=t=>{const[e,...r]=t.split("|");let a=C(e);return r.forEach((t=>{const e=t.trim();""!==e&&e in w&&(a=w[e](a))})),a};function C(t,e=q()){q();const r=t.split("."),a=r.shift().trim();return a in e&&r.length>0?C(r.join("."),e[a]):e[a]}const w={amount:t=>{if("Shopify"in window&&"formatMoney"in Shopify)return Shopify.formatMoney(t,"{{ amount }}")},amount_no_decimals:t=>{if("Shopify"in window&&"formatMoney"in Shopify)return Shopify.formatMoney(t,"{{ amount_no_decimals }}")},amount_with_comma_separator:t=>{if("Shopify"in window&&"formatMoney"in Shopify)return Shopify.formatMoney(t,"{{ amount_with_comma_separator }}")},amount_no_decimals_with_comma_separator:t=>{if("Shopify"in window&&"formatMoney"in Shopify)return Shopify.formatMoney(t,"{{ amount_no_decimals_with_comma_separator }}")},amount_with_apostrophe_separator:t=>{if("Shopify"in window&&"formatMoney"in Shopify)return Shopify.formatMoney(t,"{{ amount_with_apostrophe_separator }}")}};function L(t){const{requestButtonAttribute:e}=p.computed;let r;const a=["/cart/change","/cart/add","/cart/clear","/cart/update"];if(this.hasAttribute(e)){const t=this.getAttribute(e);if(t){let o;try{if(o=new URL(t,window.location.origin),!a.includes(o.pathname))throw"URL should be one of the following: /cart/change, /cart/add, /cart/update, /cart/clear";r=o}catch(t){console.error(`Liquid Ajax Cart: ${e} contains an invalid URL as a parameter.`,t)}}}if(void 0===r&&this.hasAttribute("href")&&"A"===this.tagName.toUpperCase()){const t=new URL(this.href);a.includes(t.pathname)?r=t:this.hasAttribute(e)&&console.error(`Liquid Ajax Cart: a link with the ${e} contains an invalid href URL.`,"URL should be one of the following: /cart/change, /cart/add, /cart/update, /cart/clear")}if(void 0===r)return;if(t.preventDefault(),q().status.requestInProgress)return;const o=new FormData;switch(r.searchParams.forEach(((t,e)=>{o.append(e,t)})),r.pathname){case"/cart/add":n(o);break;case"/cart/change":i(o);break;case"/cart/update":c(o);break;case"/cart/clear":u()}}function E(t){const{toggleClassButtonAttribute:e}=p.computed;if(!this.hasAttribute(e))return;t.preventDefault();const r=this.getAttribute(e).split("|");if(!r)return void console.error("Liquid Ajax Cart: Error while toggling body class");const a=r[0].trim();let o=r[1]?r[1].trim():"toggle";if("add"!==o&&"remove"!==o&&(o="toggle"),a)try{"add"===o?document.body.classList.add(a):"remove"===o?document.body.classList.remove(a):document.body.classList.toggle(a)}catch(t){console.error("Liquid Ajax Cart: Error while toggling body class:",a),console.error(t)}}function v(t){const{quantityInputAttribute:e}=p.computed;if(!this.hasAttribute(e))return;if(t.preventDefault(),q().status.requestInProgress)return;let r=Number(this.value.trim());const a=this.getAttribute(e).trim();isNaN(r)?console.error("Liquid Ajax Cart: input value of a data-ajax-cart-quantity-input must be an Integer number"):(r<1&&(r=0),a?(i({id:a,quantity:r}),this.blur()):console.error("Liquid Ajax Cart: attribute value of a data-ajax-cart-quantity-input must be an item key"))}function _(t){const{quantityInputAttribute:e}=p.computed;if(!this.hasAttribute(e))return;const r=this,a=q();if(a.status.cartStateSet){const t=a.cart.items.find((t=>t.key===r.getAttribute(e).trim()));t&&(r.value=t.quantity)}this.blur()}A(j),j(q()),d(((t,e)=>{const{sectionsAttribute:r,sectionScrollAreaAttribute:a}=p.computed;if(void 0!==t.requestBody){const e=[];document.querySelectorAll(`[${r}]`).forEach((t=>{let r=t.parentElement.id;if(0===r.indexOf("shopify-section-")){const t=r.replace("shopify-section-","");-1===e.indexOf(t)&&e.push(t)}})),e.length&&(t.requestBody instanceof FormData||t.requestBody instanceof URLSearchParams?t.requestBody.append("sections",e.join(",")):t.requestBody.sections=e.join(","))}e((t=>{const{sectionsAttribute:e,sectionScrollAreaAttribute:r}=p.computed;if("responseData"in t&&t.responseData.ok&&"sections"in t.responseData.body){const a=t.responseData.body.sections;for(let t in a)document.querySelectorAll(`#shopify-section-${t} > [${e}]`).forEach((e=>{const o="__noId__",s={},n=e.parentNode;e.parentNode.querySelectorAll(` [${r}] `).forEach((t=>{let e=t.getAttribute(r).toString().trim();""===e&&(e=o),e in s||(s[e]=[]),s[e].push(t.scrollTop)})),n.insertAdjacentHTML("beforeBegin",a[t]);const i=n.previousSibling;n.parentElement.removeChild(n);for(let t in s)i.querySelectorAll(` [${r}="${t.replace(o,"")}"] `).forEach(((e,r)=>{r+1<=s[t].length&&(e.scrollTop=s[t][r])}))}))}}))})),document.addEventListener("click",(function(t){for(var e=t.target;e&&e!=this;e=e.parentNode)L.call(e,t),E.call(e,t)}),!1),document.addEventListener("change",(function(t){v.call(t.target,t)}),!1),document.addEventListener("keydown",(function(t){const{quantityInputAttribute:e}=p.computed;"Enter"===t.key&&v.call(t.target,t),"Escape"===t.key&&_.call(t.target,t)}),!1),A((function(t){const{quantityInputAttribute:e}=p.computed;t.status.requestInProgress?document.querySelectorAll(`[${e}]`).forEach((t=>{t.readOnly=!0})):document.querySelectorAll(`[${e}]`).forEach((r=>{if(t.status.cartStateSet){const a=t.cart.items.find((t=>t.key===r.getAttribute(e).trim()));a&&(r.value=a.quantity)}r.readOnly=!1}))}));const D=new WeakMap;function k(t,e=""){t.querySelectorAll(`[${p.computed.productFormsErrorsAttribute}]`).forEach((t=>{t.innerText=e||""}));const r=D.get(t);p.computed.productFormsProcessingClass&&(r>0?t.classList.add(p.computed.productFormsProcessingClass):t.classList.remove(p.computed.productFormsProcessingClass))}document.addEventListener("submit",(t=>{const e=t.target;let r,a="";if("/cart/add"!==new URL(t.target.action).pathname)return;if("productFormsFilter"in p&&!p.productFormsFilter(e))return;if(t.preventDefault(),r=D.get(e),r>0||(r=0),r>0)return;const o=new FormData(e);D.set(e,r+1),k(e),n(o,{lastComplete:t=>{"responseData"in t?t.responseData.ok||(a="description"in t.responseData.body?t.responseData.body.description:"message"in t.responseData.body?t.responseData.body.message:`Error ${t.responseData.status}`):"fetchError"in t&&(a=t.fetchError);const r=D.get(e);r>0&&D.set(e,r-1),k(e,a)}})}));const B=t=>{const{cartStateSetBodyClass:e,requestInProgressBodyClass:r,emptyCartBodyClass:a,notEmptyCartBodyClass:o}=p.computed;e&&(t.status.cartStateSet?document.body.classList.add(e):document.body.classList.remove(e)),r&&(t.status.requestInProgress?document.body.classList.add(r):document.body.classList.remove(r)),a&&(t.status.cartStateSet&&0===t.cart.item_count?document.body.classList.add(a):document.body.classList.remove(a)),o&&(t.status.cartStateSet&&0===t.cart.item_count?document.body.classList.remove(o):document.body.classList.add(o))};A(B),B(q());var R=e.x$,F=e.nd,P=e.yF,$=e.fi,I=e.Be,T=e.jQ,M=e.KJ,O=e.Q4,U=e.w0;export{R as cartRequestAdd,F as cartRequestChange,P as cartRequestClear,$ as cartRequestGet,I as cartRequestUpdate,T as configure,M as getCartState,O as subscribeToCartAjaxRequests,U as subscribeToCartStateUpdate};